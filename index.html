<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darpan 24 - Premium News Portal</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.3);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .dark {
            --glass-bg: rgba(15, 23, 42, 0.8);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        * {
            font-family: 'Inter', sans-serif;
        }

        .font-devanagari {
            font-family: 'Noto Sans Devanagari', 'Inter', sans-serif;
        }

        .glassmorphism {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
        }

        .live-beacon {
            animation: pulse-beacon 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse-beacon {
            0%, 100% {
                opacity: 1;
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
            }
            50% {
                opacity: 0.8;
                box-shadow: 0 0 0 8px rgba(34, 197, 94, 0);
            }
        }

        .card-enter {
            opacity: 0;
            transform: translateY(40px);
        }

        .card-enter-active {
            opacity: 1;
            transform: translateY(0);
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .news-card {
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .news-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .news-card:hover .card-image {
            transform: scale(1.08);
        }

        .card-image {
            transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .gradient-text {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #4f46e5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        .dark .shimmer {
            background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
            background-size: 200% 100%;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .loading-skeleton {
            border-radius: 12px;
            overflow: hidden;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .dark ::-webkit-scrollbar-track {
            background: #1e293b;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: #475569;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .brand-logo {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .category-badge {
            background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
        }

        .dark .category-badge {
            background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
        }

        /* Search Bar Styles */
        .search-container {
            position: relative;
        }

        .search-input {
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .search-input:focus {
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15);
        }

        .dark .search-input:focus {
            box-shadow: 0 0 0 4px rgba(129, 140, 248, 0.2);
        }

        .search-icon {
            transition: all 0.3s ease;
        }

        .search-container:focus-within .search-icon {
            color: #4f46e5;
            transform: scale(1.1);
        }

        .dark .search-container:focus-within .search-icon {
            color: #818cf8;
        }

        .clear-btn {
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.2s ease;
        }

        .clear-btn.visible {
            opacity: 1;
            transform: scale(1);
        }

        .no-results-animation {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .search-highlight {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(124, 58, 237, 0.2) 100%);
            border-radius: 2px;
            padding: 0 2px;
        }

        .dark .search-highlight {
            background: linear-gradient(135deg, rgba(129, 140, 248, 0.3) 0%, rgba(167, 139, 250, 0.3) 100%);
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 min-h-screen transition-colors duration-300">
    <!-- Sticky Header with Glassmorphism -->
    <header class="fixed top-0 left-0 right-0 z-50 glassmorphism">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16 md:h-20">
                <!-- Brand Identity -->
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <div class="w-12 h-12 md:w-14 md:h-14 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-500/30">
                            <span class="text-white font-black text-xl md:text-2xl">D</span>
                        </div>
                        <div class="absolute -bottom-1 -right-1 w-5 h-5 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center">
                            <span class="text-white font-bold text-xs">24</span>
                        </div>
                    </div>
                    <div class="hidden sm:block">
                        <h1 class="text-2xl md:text-3xl font-black brand-logo tracking-tight">Darpan 24</h1>
                        <p class="text-xs text-slate-500 dark:text-slate-400 font-medium -mt-1">Premium News Network</p>
                    </div>
                </div>

                <!-- Right Section -->
                <div class="flex items-center gap-4 md:gap-6">
                    <!-- Live Beacon -->
                    <div class="flex items-center gap-2 bg-slate-100 dark:bg-slate-800 px-3 py-2 rounded-full">
                        <div class="w-2.5 h-2.5 bg-green-500 rounded-full live-beacon"></div>
                        <span class="text-xs md:text-sm font-semibold text-slate-700 dark:text-slate-300 uppercase tracking-wider">System Live</span>
                    </div>

                    <!-- Dark Mode Toggle -->
                    <button id="darkModeToggle" class="relative w-14 h-8 bg-slate-200 dark:bg-slate-700 rounded-full p-1 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900">
                        <div class="dark-toggle-circle w-6 h-6 bg-white rounded-full shadow-md transform transition-transform duration-300 flex items-center justify-center">
                            <svg class="sun-icon w-4 h-4 text-amber-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"/>
                            </svg>
                            <svg class="moon-icon w-4 h-4 text-indigo-600 hidden" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pt-24 md:pt-28 pb-16 px-4 sm:px-6 lg:px-8">
        <div class="max-w-7xl mx-auto">
            <!-- Section Header -->
            <div class="mb-10 md:mb-14">
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-1.5 h-8 bg-gradient-to-b from-indigo-600 to-purple-600 rounded-full"></div>
                    <h2 class="text-sm md:text-base font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest">Breaking Stories</h2>
                </div>
                <h3 class="text-3xl md:text-5xl font-black text-slate-900 dark:text-white leading-tight">
                    Latest <span class="gradient-text">Headlines</span>
                </h3>
                <p class="mt-3 text-slate-500 dark:text-slate-400 text-lg max-w-2xl">Stay informed with our curated selection of the most important news from around the world.</p>
            </div>

            <!-- Professional Search Bar -->
            <div class="mb-10 md:mb-12">
                <div class="search-container max-w-2xl mx-auto">
                    <div class="relative">
                        <!-- Search Icon -->
                        <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none">
                            <svg class="search-icon w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </div>
                        
                        <!-- Search Input -->
                        <input 
                            type="text" 
                            id="searchInput" 
                            placeholder="खबर खोजें... / Search news..." 
                            class="search-input font-devanagari w-full pl-14 pr-14 py-4 md:py-5 bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-2xl text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 text-base md:text-lg focus:outline-none focus:border-indigo-500 dark:focus:border-indigo-400 shadow-lg shadow-slate-200/50 dark:shadow-slate-900/50"
                        >
                        
                        <!-- Clear Button -->
                        <button id="clearSearch" class="clear-btn absolute inset-y-0 right-0 pr-5 flex items-center">
                            <div class="w-8 h-8 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-full flex items-center justify-center transition-colors">
                                <svg class="w-4 h-4 text-slate-500 dark:text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </div>
                        </button>
                    </div>
                    
                    <!-- Search Stats -->
                    <div id="searchStats" class="hidden mt-4 flex items-center justify-center gap-2 text-sm text-slate-500 dark:text-slate-400">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                        <span><strong id="matchCount" class="text-indigo-600 dark:text-indigo-400">0</strong> खबरें मिलीं "<span id="searchTerm" class="font-semibold"></span>" के लिए</span>
                    </div>
                </div>
            </div>

            <!-- No Search Results State -->
            <div id="noSearchResults" class="hidden text-center py-16">
                <div class="no-results-animation w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-amber-100 to-orange-100 dark:from-amber-900/30 dark:to-orange-900/30 rounded-full flex items-center justify-center">
                    <svg class="w-10 h-10 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
                <h4 class="text-xl font-bold text-slate-900 dark:text-white mb-2 font-devanagari">कोई खबर नहीं मिली!</h4>
                <p class="text-slate-500 dark:text-slate-400 max-w-md mx-auto font-devanagari">
                    "<span id="noResultsQuery" class="font-semibold text-indigo-600 dark:text-indigo-400"></span>" से मेल खाती कोई खबर नहीं मिली। कृपया दूसरे शब्द आज़माएं।
                </p>
            </div>

            <!-- Loading State -->
            <div id="loadingState" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- Skeleton Cards -->
                <div class="loading-skeleton bg-white dark:bg-slate-800 rounded-2xl overflow-hidden shadow-lg">
                    <div class="shimmer h-52"></div>
                    <div class="p-6">
                        <div class="shimmer h-4 w-20 rounded-full mb-4"></div>
                        <div class="shimmer h-6 w-full rounded mb-3"></div>
                        <div class="shimmer h-6 w-3/4 rounded mb-4"></div>
                        <div class="shimmer h-4 w-full rounded mb-2"></div>
                        <div class="shimmer h-4 w-5/6 rounded"></div>
                    </div>
                </div>
                <div class="loading-skeleton bg-white dark:bg-slate-800 rounded-2xl overflow-hidden shadow-lg hidden md:block">
                    <div class="shimmer h-52"></div>
                    <div class="p-6">
                        <div class="shimmer h-4 w-20 rounded-full mb-4"></div>
                        <div class="shimmer h-6 w-full rounded mb-3"></div>
                        <div class="shimmer h-6 w-3/4 rounded mb-4"></div>
                        <div class="shimmer h-4 w-full rounded mb-2"></div>
                        <div class="shimmer h-4 w-5/6 rounded"></div>
                    </div>
                </div>
                <div class="loading-skeleton bg-white dark:bg-slate-800 rounded-2xl overflow-hidden shadow-lg hidden lg:block">
                    <div class="shimmer h-52"></div>
                    <div class="p-6">
                        <div class="shimmer h-4 w-20 rounded-full mb-4"></div>
                        <div class="shimmer h-6 w-full rounded mb-3"></div>
                        <div class="shimmer h-6 w-3/4 rounded mb-4"></div>
                        <div class="shimmer h-4 w-full rounded mb-2"></div>
                        <div class="shimmer h-4 w-5/6 rounded"></div>
                    </div>
                </div>
            </div>

            <!-- News Grid -->
            <div id="newsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8 hidden">
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="hidden text-center py-20">
                <div class="w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 rounded-full flex items-center justify-center">
                    <svg class="w-12 h-12 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
                    </svg>
                </div>
                <h4 class="text-2xl font-bold text-slate-900 dark:text-white mb-3">No Articles Found</h4>
                <p class="text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-6">
                    Drop HTML article files into the <code class="bg-slate-200 dark:bg-slate-700 px-2 py-1 rounded text-sm font-mono">articles/</code> folder to see them appear here automatically.
                </p>
                <div class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 max-w-lg mx-auto text-left">
                    <p class="text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Expected format:</p>
                    <code class="text-xs text-indigo-600 dark:text-indigo-400 font-mono">
                        articles/article1.html<br>
                        articles/article2.html<br>
                        articles/article3.html<br>
                        ...
                    </code>
                </div>
            </div>

            <!-- Stats Bar -->
            <div id="statsBar" class="hidden mt-12 bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 rounded-2xl p-6 md:p-8 shadow-xl shadow-indigo-500/20">
                <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                    <div class="text-center md:text-left">
                        <p class="text-indigo-200 text-sm font-medium mb-1">Total Articles Loaded</p>
                        <p id="articleCount" class="text-4xl md:text-5xl font-black text-white">0</p>
                    </div>
                    <div class="flex items-center gap-2 text-white/80">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                        </svg>
                        <span class="text-sm font-medium">Auto-detected from articles/ directory</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-black text-lg">D</span>
                    </div>
                    <span class="font-bold text-slate-900 dark:text-white">Darpan 24</span>
                </div>
                <p class="text-sm text-slate-500 dark:text-slate-400">
                    Crafted with precision by <span class="font-semibold text-indigo-600 dark:text-indigo-400">Utkarsh Maurya</span>
                </p>
                <p class="text-xs text-slate-400 dark:text-slate-500">© 2024 All rights reserved</p>
            </div>
        </div>
    </footer>

    <script>
        // Dark Mode Functionality
        const darkModeToggle = document.getElementById('darkModeToggle');
        const html = document.documentElement;
        const sunIcon = document.querySelector('.sun-icon');
        const moonIcon = document.querySelector('.moon-icon');
        const toggleCircle = document.querySelector('.dark-toggle-circle');

        // Check for saved preference or system preference
        const savedTheme = localStorage.getItem('theme');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
            html.classList.add('dark');
            updateToggleUI(true);
        }

        darkModeToggle.addEventListener('click', () => {
            const isDark = html.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateToggleUI(isDark);
        });

        function updateToggleUI(isDark) {
            if (isDark) {
                toggleCircle.style.transform = 'translateX(24px)';
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            } else {
                toggleCircle.style.transform = 'translateX(0)';
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            }
        }

        // Article Auto-Detection System
        const newsGrid = document.getElementById('newsGrid');
        const loadingState = document.getElementById('loadingState');
        const emptyState = document.getElementById('emptyState');
        const statsBar = document.getElementById('statsBar');
        const articleCount = document.getElementById('articleCount');

        const categories = ['Politics', 'Technology', 'Business', 'Sports', 'Entertainment', 'World', 'Science', 'Health'];
        const categoryColors = {
            'Politics': 'from-red-500 to-rose-600',
            'Technology': 'from-blue-500 to-cyan-600',
            'Business': 'from-green-500 to-emerald-600',
            'Sports': 'from-orange-500 to-amber-600',
            'Entertainment': 'from-pink-500 to-fuchsia-600',
            'World': 'from-indigo-500 to-purple-600',
            'Science': 'from-teal-500 to-cyan-600',
            'Health': 'from-lime-500 to-green-600'
        };

        async function fetchArticle(index) {
            try {
                const response = await fetch(`articles/article${index}.html`);
                if (!response.ok) {
                    return null;
                }
                const html = await response.text();
                return parseArticle(html, index);
            } catch (error) {
                return null;
            }
        }

        function parseArticle(html, index) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');

            // Extract title
            const title = doc.querySelector('title')?.textContent || 
                         doc.querySelector('h1')?.textContent || 
                         `Article ${index}`;

            // Extract first image
            const img = doc.querySelector('img');
            const imageSrc = img?.src || img?.getAttribute('src') || 
                            `https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=600&h=400&fit=crop&q=80`;

            // Extract summary - try meta description, first paragraph, or first text content
            let summary = doc.querySelector('meta[name="description"]')?.content ||
                         doc.querySelector('p')?.textContent ||
                         doc.body?.textContent?.substring(0, 200) ||
                         'Click to read the full article...';
            
            // Clean and truncate summary
            summary = summary.replace(/\s+/g, ' ').trim();
            if (summary.length > 150) {
                summary = summary.substring(0, 150).trim() + '...';
            }

            // Extract category if available, otherwise random
            const category = doc.querySelector('meta[name="category"]')?.content ||
                           doc.querySelector('.category')?.textContent ||
                           categories[Math.floor(Math.random() * categories.length)];

            // Extract date if available
            const date = doc.querySelector('meta[name="date"]')?.content ||
                        doc.querySelector('time')?.textContent ||
                        new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

            // Extract author if available
            const author = doc.querySelector('meta[name="author"]')?.content ||
                          doc.querySelector('.author')?.textContent ||
                          'Darpan 24 Desk';

            return {
                title,
                imageSrc,
                summary,
                category,
                date,
                author,
                url: `articles/article${index}.html`
            };
        }

        function createNewsCard(article, index) {
            const colorClass = categoryColors[article.category] || 'from-indigo-500 to-purple-600';
            
            const card = document.createElement('article');
            card.className = 'news-card card-enter bg-white dark:bg-slate-800 rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl cursor-pointer group';
            card.style.transitionDelay = `${index * 100}ms`;

            card.innerHTML = `
                <a href="${article.url}" class="block">
                    <div class="relative h-52 overflow-hidden">
                        <img src="${article.imageSrc}" 
                             alt="${article.title}" 
                             class="card-image w-full h-full object-cover"
                             onerror="this.src='https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=600&h=400&fit=crop&q=80'">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
                        <div class="absolute top-4 left-4">
                            <span class="px-3 py-1.5 bg-gradient-to-r ${colorClass} text-white text-xs font-bold uppercase tracking-wider rounded-full shadow-lg">
                                ${article.category}
                            </span>
                        </div>
                        <div class="absolute bottom-4 left-4 right-4">
                            <p class="text-white/80 text-xs font-medium">${article.date}</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="font-devanagari text-xl font-bold text-slate-900 dark:text-white mb-3 line-clamp-2 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors">
                            ${article.title}
                        </h3>
                        <p class="font-devanagari text-slate-600 dark:text-slate-400 text-sm leading-relaxed line-clamp-3 mb-4">
                            ${article.summary}
                        </p>
                        <div class="flex items-center justify-between pt-4 border-t border-slate-100 dark:border-slate-700">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-full flex items-center justify-center">
                                    <span class="text-white text-xs font-bold">${article.author.charAt(0)}</span>
                                </div>
                                <span class="text-xs font-medium text-slate-500 dark:text-slate-400">${article.author}</span>
                            </div>
                            <div class="flex items-center gap-1 text-indigo-600 dark:text-indigo-400 text-sm font-semibold group-hover:gap-2 transition-all">
                                <span>Read</span>
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                </a>
            `;

            return card;
        }

        async function loadArticles() {
            const articles = [];
            let index = 1;
            let consecutiveFailures = 0;
            const maxConsecutiveFailures = 3; // Allow some gaps in numbering

            while (consecutiveFailures < maxConsecutiveFailures) {
                const article = await fetchArticle(index);
                if (article) {
                    articles.push(article);
                    consecutiveFailures = 0;
                } else {
                    consecutiveFailures++;
                }
                index++;
                
                // Safety limit
                if (index > 100) break;
            }

            // Hide loading state
            loadingState.classList.add('hidden');

            if (articles.length === 0) {
                // Show empty state
                emptyState.classList.remove('hidden');
            } else {
                // Show news grid
                newsGrid.classList.remove('hidden');
                statsBar.classList.remove('hidden');
                articleCount.textContent = articles.length;

                // Create and append cards with staggered animation
                articles.forEach((article, i) => {
                    const card = createNewsCard(article, i);
                    newsGrid.appendChild(card);
                    
                    // Store for search functionality
                    storeArticleData(article, card);

                    // Trigger animation after append
                    requestAnimationFrame(() => {
                        setTimeout(() => {
                            card.classList.remove('card-enter');
                            card.classList.add('card-enter-active');
                        }, 50 + (i * 100));
                    });
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Simulate minimum loading time for smooth UX
            setTimeout(loadArticles, 800);
        });

        // Add line-clamp utility
        const style = document.createElement('style');
        style.textContent = `
            .line-clamp-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            .line-clamp-3 {
                display: -webkit-box;
                -webkit-line-clamp: 3;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
        `;
        document.head.appendChild(style);

        // =============================================
        // SEARCH FUNCTIONALITY
        // =============================================
        
        const searchInput = document.getElementById('searchInput');
        const clearSearch = document.getElementById('clearSearch');
        const searchStats = document.getElementById('searchStats');
        const matchCount = document.getElementById('matchCount');
        const searchTerm = document.getElementById('searchTerm');
        const noSearchResults = document.getElementById('noSearchResults');
        const noResultsQuery = document.getElementById('noResultsQuery');

        let allArticleCards = [];
        let allArticlesData = [];

        // Store articles data for search
        function storeArticleData(article, card) {
            allArticlesData.push({
                article: article,
                card: card,
                titleLower: article.title.toLowerCase()
            });
            allArticleCards.push(card);
        }

        // Real-time search filter function
        function filterArticles(query) {
            const searchQuery = query.toLowerCase().trim();
            
            // Show/hide clear button
            if (searchQuery.length > 0) {
                clearSearch.classList.add('visible');
            } else {
                clearSearch.classList.remove('visible');
            }

            // If no query, show all articles
            if (searchQuery === '') {
                allArticleCards.forEach((card, index) => {
                    card.style.display = '';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                    
                    // Remove any highlights
                    const titleEl = card.querySelector('h3');
                    if (titleEl && titleEl.dataset.originalTitle) {
                        titleEl.innerHTML = titleEl.dataset.originalTitle;
                    }
                });
                
                searchStats.classList.add('hidden');
                noSearchResults.classList.add('hidden');
                newsGrid.classList.remove('hidden');
                return;
            }

            let matchedCount = 0;

            allArticlesData.forEach((data, index) => {
                const card = data.card;
                const title = data.article.title;
                const titleLower = data.titleLower;
                
                if (titleLower.includes(searchQuery)) {
                    // Show matching card with animation
                    card.style.display = '';
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, matchedCount * 50);
                    
                    // Highlight matching text
                    const titleEl = card.querySelector('h3');
                    if (titleEl) {
                        if (!titleEl.dataset.originalTitle) {
                            titleEl.dataset.originalTitle = title;
                        }
                        const regex = new RegExp(`(${escapeRegex(query)})`, 'gi');
                        titleEl.innerHTML = title.replace(regex, '<span class="search-highlight">$1</span>');
                    }
                    
                    matchedCount++;
                } else {
                    // Hide non-matching card
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        card.style.display = 'none';
                    }, 200);
                    
                    // Remove highlight
                    const titleEl = card.querySelector('h3');
                    if (titleEl && titleEl.dataset.originalTitle) {
                        titleEl.innerHTML = titleEl.dataset.originalTitle;
                    }
                }
            });

            // Update search stats
            if (matchedCount > 0) {
                matchCount.textContent = matchedCount;
                searchTerm.textContent = query;
                searchStats.classList.remove('hidden');
                noSearchResults.classList.add('hidden');
                newsGrid.classList.remove('hidden');
            } else {
                searchStats.classList.add('hidden');
                noSearchResults.classList.remove('hidden');
                noResultsQuery.textContent = query;
                newsGrid.classList.add('hidden');
            }
        }

        // Escape special regex characters
        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        // Search input event listener with debounce
        let searchTimeout;
        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                filterArticles(e.target.value);
            }, 150);
        });

        // Clear search button
        clearSearch.addEventListener('click', () => {
            searchInput.value = '';
            filterArticles('');
            searchInput.focus();
        });

        // Keyboard shortcut (Ctrl/Cmd + K) to focus search
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                searchInput.focus();
                searchInput.select();
            }
            // ESC to clear search
            if (e.key === 'Escape' && document.activeElement === searchInput) {
                searchInput.value = '';
                filterArticles('');
                searchInput.blur();
            }
        });
    </script>
</body>
</html>
